---
name: create-performance
description: "性能要件ドキュメント(docs/performance.md)を作成します"
args:
  optional: []
  required: []
---

# 性能要件ドキュメント作成

このコマンドは性能要件ドキュメント (`docs/performance.md`) を作成します。

## 処理フロー

1. 既存ドキュメントから性能要件情報を収集
2. 性能要件ドキュメントを作成

## Phase 1: 情報収集

### 1. docs配下の情報収集
```bash
# document-explorerエージェントを使用してdocs配下から性能要件を収集
```

### 2. note配下の情報収集  
```bash
# note-explorerエージェントを使用してnote配下から性能要件を収集
```

## Phase 2: ドキュメント作成

```bash
# Task toolを使用してdocument-explorerエージェントを起動
task --subagent_type document-explorer --prompt "docs配下のファイルから性能要件に関する情報を抽出してください"

# Task toolを使用してnote-explorerエージェントを起動  
task --subagent_type note-explorer --prompt "note配下のファイルから性能要件に関する情報を抽出してください"

# 収集した情報を基にdocs/performance.mdを作成
write --file_path "docs/performance.md" --content "
# 性能要件

## 1. 目的

本システムがビジネス要件およびユーザーの期待を満たすために必要な、処理能力、応答時間、およびリソース効率に関する基準を定義する。

## 2. 目標性能値

主要なユースケースにおける目標値を以下の通り定める。

| 項目 | 指標 | 目標値 | 備考 |
|------|------|--------|------|
| 応答速度 | 画面表示（低負荷時） | 2秒以内 | ユーザー操作から描画完了まで |
| | APIレスポンス | 500ms以内 | サーバーサイドの処理時間 |
| スループット | 同時実行ユーザー数 | 1,000ユーザー | 想定される最大同時接続数 |
| | 最大秒間リクエスト数 | 200 req/sec | ピーク時の負荷 |
| データ処理 | バッチ処理時間 | 4時間以内 | 深夜バッチ（0:00〜4:00）で完結 |

## 3. 負荷特性

システムが耐えうる負荷の限界と条件：

- 通常負荷: 日中時間帯（9:00 - 18:00）、平均 50 req/sec
- ピーク負荷: キャンペーン実施時、通常時の5倍（250 req/sec）を想定
- データ量: 運用開始3年後において、メインテーブルのレコード数 1,000万件

## 4. リソース効率

- CPU使用率: 定常時 40%以下、ピーク時 80%を超えないこと
- メモリ使用率: 常に 70%以下を維持すること
- ディスク容量: ログおよびデータ保存領域に 20%以上の空きを確保すること

## 5. 測定・検証方法

性能要件を満たしているかを確認するための検証計画：

- 使用ツール: JMeter / Locust
- 実施時期: 結合テストフェーズ終了後およびリリース前
- 検証項目:
  - ロードテスト（目標負荷での安定性）
  - ストレステスト（限界負荷時の挙動と復旧）
  - ロングランテスト（メモリリークの有無）
"
```
